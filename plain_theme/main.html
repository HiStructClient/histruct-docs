{% from "partials/i18n.html" import t with context %}
{% from "partials/navigation.html" import render_navigation with context %}

<!DOCTYPE html>
<html lang="{ config.theme.locale.language }">

<head>
    <meta charset="utf-8">
    <title>{{ page.title }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script>
        window.addEventListener("DOMContentLoaded", () => {
            try {
                if (window.self !== window.top) {
                    document.body.classList.add("in-iframe");
                }
            } catch {
                document.body.classList.add("in-iframe"); // cross-origin ‚Üí urƒçitƒõ v iframu
            }
        });

        window.addEventListener("message", function (e) {
            var options = e.data;
            if (options?.styles) {
                var style = document.createElement("style");
                style.innerHTML = options.styles;
                document.head.appendChild(style);
            }
        });

        function openVideoModal(elementId) {
            const dialogEle = document.getElementById(elementId);
            dialogEle.style.display = 'flex';
            const v = dialogEle.getElementsByTagName('video')[0];
            v.muted = true;
            v.play();
        }

        function closeVideoModal(elementId) {
            const dialogEle = document.getElementById(elementId);
            dialogEle.style.display = 'none';
            const v = dialogEle.getElementsByTagName('video')[0];
            v.pause();
            v.currentTime = 0;
        }
    </script>

    <link href="/style.css" rel="stylesheet">

    {% if config.extra.dev_mode %}
    <link href="/style_deve.css" rel="stylesheet">
    {% endif %}

</head>

<body class="d-flex">
    <article class="flex-grow-1">
        {% if config.extra.dev_mode %}
        <div class="open-in-vscode">
            <a href="vscode://file/{{ page.file.abs_src_path }}">üìù Open in VS Code</a>
        </div>
        {% endif %}

        {{ page.content }}

        <h2 class="pt-4">{{ t("next_help_title") }}</h2>
        <p>{{ t("next_help_description") }}</p>
        <div class="d-flex gap-2">
            <a href="https://docs.histruct.com/{ config.theme.locale.language }/" class="btn">
                {{ t("visit_blog") }}
            </a>
            <a href="mailto:support@histruct.com?subject=Dotaz na Support HiStruct" class="btn">
                {{ t("send_query") }}
            </a>
        </div>

    </article>

    {% if config.extra.dev_mode %}
    <nav>
        {% if nav|length > 1 and config.extra.dev_mode %}
            {{ render_navigation(nav) }}
        {% endif %}
    </nav>
    {% endif %}

</body>

{% if config.extra.dev_mode %}
<script>
    window.addEventListener("DOMContentLoaded", function () {
        const nav = document.querySelector("nav");
        const activeLink = nav?.querySelector("a.active");
        if (nav && activeLink) {
            const linkTop = activeLink.offsetTop;
            const linkBottom = linkTop + activeLink.offsetHeight;

            const viewTop = nav.scrollTop;
            const viewBottom = viewTop + nav.clientHeight;

            // Pokud odkaz u≈æ je viditeln√Ω, nedƒõlej nic
            if (linkTop >= viewTop && linkBottom <= viewBottom) {
                return;
            }

            // pozice aktivn√≠ho odkazu v≈Øƒçi nav
            const offsetTop = activeLink.offsetTop;

            // posu≈à scroll, t≈ôeba 50px pod horn√≠ okraj
            nav.scrollTop = linkTop - 75;
        }
    });
</script>
{% endif %}


</html>